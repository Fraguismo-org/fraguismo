{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mt-4">
    <div class="card">
        <div class="card-header">
            <h5>{{ proposta.titulo }}</h5>
        </div>
        <div class="card-body">
            <p><strong>Valor:</strong> R$ {{ proposta.valor }}</p>
            <p><strong>Hash do arquivo:</strong> {{ proposta.hash_arquivo }}</p>
            <p><strong>Data de criação:</strong> {{ proposta.data_criacao|date:"d/m/Y H:i" }}</p>

            {% if conteudo_txt %}
                <div class="mt-3">
                    <h6>Conteúdo do arquivo .txt:</h6>
                    <pre>{{ conteudo_txt }}</pre>
                </div>
            {% else %}
                <a href="{{ proposta.arquivo.url }}" class="btn btn-sm btn-secondary" download>
                    Baixar Arquivo
                </a>
            {% endif %}
            <div class="mt-3">
                <h5>Votos</h5>
                <p>A favor: {{ votos_favor }}</p>
                <p>Contra: {{ votos_contra }}</p>
            </div>
            {% if pode_votar %}
                <a href="{% url 'vote_proposal' proposta.id %}" class="btn btn-primary mt-2">Votar nesta proposta</a>
            {% endif %}
            <h5 class="mt-3">Quem votou:</h5>
            <ul>
                {% for voto in votos %}
                    <li>{{ voto.usuario.username }} — 
                        {% if voto.votos %}
                            A favor
                        {% else %}
                            Contra
                        {% endif %}
                    </li>
                {% empty %}
                    <li>Ninguém votou ainda.</li>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>
{% endblock content %}